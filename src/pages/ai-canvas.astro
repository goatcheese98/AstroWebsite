---
import BaseLayout from "../layouts/BaseLayout.astro";
import ExcalidrawCanvas from "../components/islands/ExcalidrawCanvas";
import AIChatSidebar from "../components/islands/AIChatSidebar";
---

<BaseLayout
  title="AI Canvas"
  description="Interactive drawing canvas powered by Excalidraw with AI assistance"
>
  <div class="canvas-layout">
    <div class="canvas-container">
      <ExcalidrawCanvas client:only="react" />
    </div>
    <aside class="chat-sidebar">
      <AIChatSidebar client:only="react" />
    </aside>
  </div>
</BaseLayout>

<style>
  .canvas-layout {
    display: flex;
    width: 100vw;
    height: 100vh;
    position: fixed;
    top: 0;
    left: 0;
    overflow: hidden;
  }

  .canvas-container {
    flex: 1;
    height: 100%;
    min-width: 0;
    /* Remove grid background for clean canvas */
    background: var(--color-bg) !important;
    background-image: none !important;
  }

  .chat-sidebar {
    width: 360px;
    height: 100%;
    flex-shrink: 0;
  }

  /* Ensure body doesn't scroll when canvas is open */
  :global(body) {
    overflow: hidden !important;
  }

  /* Make Excalidraw fill its container */
  :global(.excalidraw-wrapper),
  :global(.excalidraw) {
    width: 100% !important;
    height: 100% !important;
  }

  /* Hide Excalidraw's default theme toggle since we sync with site theme */
  :global(.excalidraw .layer-ui__wrapper__top-right) {
    display: none;
  }

  @media (max-width: 768px) {
    .canvas-layout {
      flex-direction: column;
    }

    .canvas-container {
      flex: 1;
      min-height: 60vh;
    }

    .chat-sidebar {
      width: 100%;
      height: 40vh;
    }
  }
</style>
