---
import { getEntry, render } from 'astro:content';
import BlogPostLayout from '../../layouts/BlogPostLayout.astro';

// For SSR mode, we get the slug from params and fetch the post
// Note: slug in URL matches the file id (filename without extension)
const { slug } = Astro.params;

// Fetch the specific post using the id (which is the filename without extension)
const post = await getEntry('blog', slug as string);

// If post doesn't exist, return 404
if (!post) {
  return Astro.redirect('/404');
}

// Render the post content using the render function
const { Content, headings } = await render(post);
---

<BlogPostLayout
  title={post.data.title}
  description={post.data.description}
  pubDate={post.data.pubDate}
  updatedDate={post.data.updatedDate}
  tags={post.data.tags}
  headings={headings}
>
  <Content />
</BlogPostLayout>
